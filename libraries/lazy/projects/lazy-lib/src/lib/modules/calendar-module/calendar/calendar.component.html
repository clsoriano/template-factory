<div [formGroup]="fgroup">
    <mat-form-field [ngClass]="divParent.class" 
                [style]="divParent.style" 
                [appearance]="inputElement.appareance"
                [floatLabel]="inputElement.floatLabel">
    
        <mat-label>{{ inputElement.label }}</mat-label>
        <div class="mat-datepicker">
            <input matInput [id]="inputElement.id"
                    [matDatepicker]="picker"
                    [formControlName]="inputElement.id"
                    [placeholder]="inputElement.placeholder" 
                    [alt]="inputElement.alt"
                    [ngClass]="inputElement.class"
                    [style]="inputElement.style"
                    [autofocus]="inputElement.autofocus"
                    [autocomplete]="inputElement.autocomplete"
                    [errorStateMatcher]="matcher"
                    (dateInput)="_handleInput(fgroup.controls[inputElement.id], $event)"
                    (click)="picker.open()"
                    [readonly]="inputElement.readonly">

            <mat-datepicker #picker touchUi 
                [startView]="inputElement.extendedAttributes?.startView || 'month'"
                [startAt]="startDate | async">
            </mat-datepicker>

            <!-- Icon position validation -->
            <ng-template [ngIf]="inputElement.icon">

                <ng-template [ngIf]="inputElement.iconPosition == 'prefix'" [ngIfElse]="suffix">
                    <mat-datepicker-toggle matPrefix [for]="picker">
                        <mat-icon matPrefix>
                            {{inputElement.icon}}
                        </mat-icon>
                    </mat-datepicker-toggle>
                </ng-template>

                <ng-template #suffix>
                    <mat-datepicker-toggle matSuffix [for]="picker">
                        <mat-icon matSuffix>
                            {{inputElement.icon}}
                        </mat-icon>
                    </mat-datepicker-toggle>
                </ng-template>

            </ng-template>
        </div>

        <mat-hint>
            {{ inputElement.hint }}
        </mat-hint>
        
        <!-- Errors on input -->
        <mat-error>
            {{ getError() }}
        </mat-error>

    </mat-form-field>
</div>